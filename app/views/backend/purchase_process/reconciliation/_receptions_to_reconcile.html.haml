- if items.any?
  = hidden_field_tag 'is-purchase-orders', false

  .modal-body
    .purchase-orders
      .list-headers
        %span.list-header.form-name= :reception.tl
        %span.list-header
        %span.list-header= :quantity.tl
        %span.list-header= :unit_amount.tl
        %span.list-header= :total_amount_without_taxes.tl
      .list-models
        - items.each do |model|
          .model
            = check_box_tag('', '1', false, class: 'model-checkbox', data: { id: model.id })

            - reference_number = model.reference_number.presence || :not_informed.tl
            %span.model-ref= :reception_number_with_reference.tl(reference_number: reference_number)
            %br
            %span.model-ref.reception-date= :reception_date.tl(date: l(model.given_at.to_date))

            %ul.list-items
              - model.items.each do |model_item|
                - datas = { variant_type: model_item.variant.variety, equipment_id: model_item.equipment_id, activity_budget_id: model_item.activity_budget_id, team_id: model_item.team_id, responsible_id: model.responsible_id, project_budget_id: model_item.project_budget_id, annotation: model_item.annotation, tax_id: model_item.purchase_order_item.try(:tax_id), reduction_percentage: model_item.purchase_order_item.try(:reduction_percentage), non_compliant: model_item.non_compliant.to_s, supplier_ref: reference_number, conditionning: model_item.storings.first&.conditionning, conditionning_quantity: model_item.storings.sum(:conditionning_quantity) }

                %li.item{ data: datas }
                  = check_box_tag('', '1', false, class: 'item-checkbox', data: { id: model_item.id })
                  %span.variant{ data: { id: model_item.variant_id } }= model_item.variant.name
                  %span.item-value
                  %span.item-value.quantity-to-fill= model_item.quantity
                  %span.item-value.unit-cost= model_item.unit_pretax_amount
                  %span.item-value.total-except-taxes= model_item.purchase_order_item.try(:pretax_amount)

  .modal-footer
    %span.total-label= :total.tl + " :"
    %span.footer-item
    %span.footer-item.total-quantity
    %span.footer-item
    %span.footer-item.total-amount
    %span.footer-item.actions
      %button{ class: "btn btn-default valid-modal" }= :valid.tl

- else
  .modal-body
    .modal-body__msg-container= :no_reception_to_reconcile_for_this_supplier.tl

  .modal-footer
    %span.total-label
    %span.footer-item
    %span.footer-item
    %span.footer-item
    %span.footer-item
    %span.footer-item.actions
      %button{ class: 'btn btn-default', data: { dismiss: 'modal' } }= :cancel.tl
